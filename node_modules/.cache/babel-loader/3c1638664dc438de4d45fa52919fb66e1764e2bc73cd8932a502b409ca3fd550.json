{"ast":null,"code":"var _jsxFileName = \"/Users/a667227/Desktop/Work/ticket-management/src/App.tsx\",\n  _s = $RefreshSig$();\nimport { useState, useEffect } from 'react';\nimport { BrowserRouter, Routes, Route, Navigate } from 'react-router-dom';\nimport './App.css';\nimport Layout from './components/Layout';\nimport RouteWrapper from './components/RouteWrapper';\nimport MyTickets from './components/tickets/MyTickets';\nimport Login from './components/Login';\nimport { createTicket, getTickets, updateTicketStatus, updateTicket, getAllTicketsRaw } from './services/api';\nimport TicketDetail from './components/tickets/TicketDetail';\nimport RequestManagement from './components/admin/RequestManagement';\nimport ProtectedRoute from './components/ProtectedRoute';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst App = () => {\n  _s();\n  var _debugInfo$data;\n  const [tickets, setTickets] = useState([]);\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n  const [currentUser, setCurrentUser] = useState(null);\n  const [debugInfo, setDebugInfo] = useState({\n    visible: false,\n    data: null\n  });\n  useEffect(() => {\n    // Check for existing auth token and user data\n    const token = localStorage.getItem('token');\n    const savedUser = localStorage.getItem('user');\n    if (token && savedUser) {\n      try {\n        const parsedUser = JSON.parse(savedUser);\n        console.log('Loaded user:', parsedUser); // Debug log\n        console.log('Token found:', token ? 'Yes (length: ' + token.length + ')' : 'No');\n        setIsAuthenticated(true);\n        setCurrentUser(parsedUser);\n        // Fetch tickets when authenticated\n        fetchTickets();\n      } catch (error) {\n        console.error('Error parsing saved user data:', error);\n        // Handle corrupted user data by clearing it\n        localStorage.removeItem('token');\n        localStorage.removeItem('user');\n        setIsAuthenticated(false);\n      }\n    } else {\n      console.log('No authentication found. Token:', !!token, 'User:', !!savedUser);\n    }\n  }, []);\n  const fetchTickets = async dateRange => {\n    try {\n      // Use a default date range if none provided (all time)\n      if (!dateRange) {\n        const end = new Date();\n        const start = new Date(2020, 0, 1); // Jan 1, 2020 instead of 365 days\n        dateRange = {\n          startDate: start,\n          endDate: end\n        };\n      }\n\n      // Ensure startDate and endDate are defined\n      const safeRange = {\n        startDate: dateRange.startDate || new Date(2020, 0, 1),\n        endDate: dateRange.endDate || new Date()\n      };\n      console.log('App fetching tickets with date range:', {\n        startDate: safeRange.startDate.toISOString(),\n        endDate: safeRange.endDate.toISOString()\n      });\n      const response = await getTickets(undefined, 1, 100, safeRange);\n\n      // Check if there was an error in the response\n      if (response.error) {\n        console.error('Error in ticket response:', response.error);\n        setDebugInfo({\n          visible: true,\n          data: {\n            status: 'error',\n            message: 'Error fetching tickets',\n            error: response.error,\n            timestamp: new Date().toISOString()\n          }\n        });\n        // Keep existing tickets instead of setting empty array\n        return;\n      }\n\n      // Handle response with tickets\n      if (response.tickets && Array.isArray(response.tickets)) {\n        const ticketsArray = response.tickets;\n        console.log(`App received ${ticketsArray.length} tickets`);\n\n        // Log first ticket data for debugging\n        if (ticketsArray.length > 0) {\n          console.log('First ticket sample:', {\n            id: ticketsArray[0]._id,\n            title: ticketsArray[0].title,\n            status: ticketsArray[0].status,\n            date: ticketsArray[0].requestDate\n          });\n        }\n        setTickets(ticketsArray);\n      } else {\n        console.warn('Unexpected ticket response format:', response);\n        setTickets([]);\n      }\n    } catch (error) {\n      console.error('Error fetching tickets:', error);\n      setDebugInfo({\n        visible: true,\n        data: {\n          status: 'error',\n          message: 'Exception fetching tickets',\n          error: (error === null || error === void 0 ? void 0 : error.message) || 'Unknown error',\n          timestamp: new Date().toISOString()\n        }\n      });\n\n      // If we get an authentication error, clear the token and redirect to login\n      if (error !== null && error !== void 0 && error.response && error.response.status === 401) {\n        console.error('Authentication error. Redirecting to login.');\n        localStorage.removeItem('token');\n        localStorage.removeItem('user');\n        setIsAuthenticated(false);\n        setCurrentUser(null);\n      }\n    }\n  };\n  const handleLoginSuccess = (token, user) => {\n    setIsAuthenticated(true);\n    setCurrentUser(user);\n    // Fetch tickets after successful login\n    fetchTickets();\n  };\n  const handleLogout = () => {\n    localStorage.removeItem('token');\n    localStorage.removeItem('user');\n    setIsAuthenticated(false);\n    setCurrentUser(null);\n    setTickets([]);\n  };\n  const handleCreateRequest = () => {\n    // Use navigate directly in components that need it\n    window.location.href = '/tickets/create';\n  };\n  const handleTicketSubmit = async (ticketData, navigate) => {\n    try {\n      await createTicket(ticketData);\n      // Fetch updated tickets list\n      await fetchTickets();\n      navigate('/tickets');\n      alert('Ticket created successfully!');\n    } catch (error) {\n      console.error('Error creating ticket:', error);\n      alert('Failed to create ticket. Please try again.');\n    }\n  };\n  const handleTicketStatusChange = async (ticketId, newStatus) => {\n    try {\n      await updateTicketStatus(ticketId, newStatus);\n      // Fetch updated tickets list\n      await fetchTickets();\n    } catch (error) {\n      console.error('Error updating ticket status:', error);\n      alert('Failed to update ticket status. Please try again.');\n    }\n  };\n  const handleUpdateTicket = async (ticketId, updatedData) => {\n    try {\n      if ('status' in updatedData) {\n        // Use status-specific endpoint for status updates\n        await updateTicketStatus(ticketId, updatedData.status);\n      } else {\n        // Use general update endpoint for other updates\n        await updateTicket(ticketId, updatedData);\n      }\n      // Fetch updated tickets list\n      await fetchTickets();\n    } catch (error) {\n      console.error('Error updating ticket:', error);\n      alert('Failed to update ticket. Please try again.');\n    }\n  };\n\n  // Add debug function to directly fetch and display the raw API response\n  const debugApiCall = async () => {\n    try {\n      var _localStorage$getItem;\n      setDebugInfo({\n        visible: true,\n        data: {\n          status: 'loading',\n          message: 'Fetching data from API...'\n        }\n      });\n\n      // Call the raw tickets endpoint\n      const rawResponse = await getAllTicketsRaw();\n      console.log('DEBUG: Raw API response:', rawResponse);\n\n      // Show detailed debug info\n      setDebugInfo({\n        visible: true,\n        data: {\n          status: 'success',\n          timestamp: new Date().toISOString(),\n          endpoint: '/tickets',\n          response: rawResponse,\n          auth: {\n            tokenExists: !!localStorage.getItem('token'),\n            tokenLength: ((_localStorage$getItem = localStorage.getItem('token')) === null || _localStorage$getItem === void 0 ? void 0 : _localStorage$getItem.length) || 0,\n            userInfo: currentUser ? {\n              id: currentUser._id,\n              role: currentUser.role,\n              email: currentUser.email\n            } : 'No user data'\n          }\n        }\n      });\n    } catch (error) {\n      var _error$response;\n      console.error('Debug API call failed:', error);\n      setDebugInfo({\n        visible: true,\n        data: {\n          status: 'error',\n          timestamp: new Date().toISOString(),\n          message: (error === null || error === void 0 ? void 0 : error.message) || 'Unknown error',\n          details: (error === null || error === void 0 ? void 0 : (_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.data) || {},\n          stack: (error === null || error === void 0 ? void 0 : error.stack) || ''\n        }\n      });\n    }\n  };\n\n  // Improved test ticket creation with detailed responses\n  const createTestTicket = async () => {\n    if (!currentUser) return;\n    try {\n      console.log('Creating test ticket...');\n      setDebugInfo({\n        visible: true,\n        data: {\n          status: 'loading',\n          message: 'Creating test ticket...'\n        }\n      });\n      const testTicketData = {\n        _id: '',\n        // This will be generated by the server\n        title: 'Test Ticket ' + new Date().toISOString(),\n        description: 'This is a test ticket created for debugging.',\n        requesterId: currentUser._id,\n        department: currentUser.department,\n        chemicalConfig: {\n          machineId: 'TEST-MACHINE',\n          machineName: 'Test Machine',\n          chemicalType: 'Test Chemical',\n          concentration: 1.0,\n          temperature: 25.0,\n          flowRate: 1.0\n        },\n        requestDate: new Date().toISOString()\n      };\n      const response = await createTicket(testTicketData);\n      console.log('Test ticket created successfully:', response);\n\n      // Show success info\n      setDebugInfo({\n        visible: true,\n        data: {\n          status: 'success',\n          message: 'Test ticket created successfully',\n          ticketData: response,\n          timestamp: new Date().toISOString()\n        }\n      });\n\n      // Fetch tickets again\n      fetchTickets();\n    } catch (error) {\n      var _error$response2;\n      console.error('Error creating test ticket:', error);\n      setDebugInfo({\n        visible: true,\n        data: {\n          status: 'error',\n          message: `Error creating test ticket: ${(error === null || error === void 0 ? void 0 : error.message) || 'Unknown error'}`,\n          details: (error === null || error === void 0 ? void 0 : (_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : _error$response2.data) || {},\n          timestamp: new Date().toISOString()\n        }\n      });\n      alert(`Error creating test ticket: ${(error === null || error === void 0 ? void 0 : error.message) || 'Unknown error'}`);\n    }\n  };\n\n  // Function to close debug panel\n  const closeDebugPanel = () => {\n    setDebugInfo({\n      ...debugInfo,\n      visible: false\n    });\n  };\n  if (!isAuthenticated || !currentUser) {\n    return /*#__PURE__*/_jsxDEV(Login, {\n      onLoginSuccess: handleLoginSuccess\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 303,\n      columnNumber: 12\n    }, this);\n  }\n\n  // If authenticated but no tickets, add a debug button\n  if (tickets.length === 0) {\n    console.log('No tickets found. Adding debug UI...');\n  }\n  return /*#__PURE__*/_jsxDEV(BrowserRouter, {\n    children: [debugInfo.visible && /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        position: 'fixed',\n        top: 0,\n        left: 0,\n        right: 0,\n        bottom: 0,\n        backgroundColor: 'rgba(0,0,0,0.8)',\n        zIndex: 9999,\n        overflow: 'auto',\n        padding: '20px',\n        color: '#fff',\n        fontFamily: 'monospace'\n      },\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          backgroundColor: '#1e1e1e',\n          padding: '20px',\n          borderRadius: '8px',\n          maxWidth: '1200px',\n          margin: '0 auto',\n          boxShadow: '0 0 20px rgba(0,0,0,0.5)'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            display: 'flex',\n            justifyContent: 'space-between',\n            marginBottom: '20px'\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n            style: {\n              color: '#61dafb',\n              margin: 0\n            },\n            children: \"API Debug Information\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 337,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: closeDebugPanel,\n            style: {\n              backgroundColor: '#e74c3c',\n              color: 'white',\n              border: 'none',\n              padding: '5px 15px',\n              borderRadius: '4px',\n              cursor: 'pointer'\n            },\n            children: \"Close\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 338,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 336,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            backgroundColor: '#2d2d2d',\n            padding: '15px',\n            borderRadius: '4px',\n            overflowX: 'auto'\n          },\n          children: /*#__PURE__*/_jsxDEV(\"pre\", {\n            style: {\n              maxHeight: '80vh',\n              margin: 0,\n              color: ((_debugInfo$data = debugInfo.data) === null || _debugInfo$data === void 0 ? void 0 : _debugInfo$data.status) === 'error' ? '#ff6b6b' : '#a3e635'\n            },\n            children: JSON.stringify(debugInfo.data, null, 2)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 359,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 353,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 328,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 315,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        padding: '10px',\n        backgroundColor: '#343a40',\n        color: 'white',\n        textAlign: 'center',\n        position: 'sticky',\n        top: 0,\n        zIndex: 1000,\n        display: 'flex',\n        justifyContent: 'center',\n        gap: '10px'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: createTestTicket,\n        style: {\n          padding: '5px 10px',\n          backgroundColor: '#28a745',\n          color: 'white',\n          border: 'none',\n          borderRadius: '4px'\n        },\n        children: \"Create Test Ticket\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 384,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: debugApiCall,\n        style: {\n          padding: '5px 10px',\n          backgroundColor: '#007bff',\n          color: 'white',\n          border: 'none',\n          borderRadius: '4px'\n        },\n        children: \"Debug API Response\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 396,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => fetchTickets(),\n        style: {\n          padding: '5px 10px',\n          backgroundColor: '#6c757d',\n          color: 'white',\n          border: 'none',\n          borderRadius: '4px'\n        },\n        children: \"Refresh Tickets\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 408,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 372,\n      columnNumber: 7\n    }, this), tickets.length === 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        padding: '10px',\n        backgroundColor: '#f8d7da',\n        color: '#721c24',\n        textAlign: 'center',\n        margin: '10px'\n      },\n      children: /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"No tickets found. Use the debug tools above to investigate.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 431,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 424,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(Routes, {\n      children: /*#__PURE__*/_jsxDEV(Route, {\n        path: \"/\",\n        element: /*#__PURE__*/_jsxDEV(Layout, {\n          currentUser: currentUser,\n          onLogout: handleLogout\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 439,\n          columnNumber: 13\n        }, this),\n        children: [/*#__PURE__*/_jsxDEV(Route, {\n          index: true,\n          element: /*#__PURE__*/_jsxDEV(RouteWrapper, {\n            component: \"home\",\n            tickets: tickets,\n            currentUser: currentUser,\n            onCreateRequest: handleCreateRequest,\n            onStatusChange: handleTicketStatusChange\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 446,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 445,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          path: \"tickets\",\n          element: /*#__PURE__*/_jsxDEV(MyTickets, {\n            tickets: tickets,\n            currentUser: currentUser\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 457,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 454,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          path: \"tickets/create\",\n          element: /*#__PURE__*/_jsxDEV(RouteWrapper, {\n            component: \"create\",\n            currentUser: currentUser,\n            onCreateRequest: handleCreateRequest,\n            onSubmit: handleTicketSubmit\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 466,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 463,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          path: \"/my-tickets\",\n          element: /*#__PURE__*/_jsxDEV(MyTickets, {\n            tickets: tickets,\n            currentUser: currentUser\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 477,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 474,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          path: \"/tickets/:id\",\n          element: /*#__PURE__*/_jsxDEV(TicketDetail, {\n            tickets: tickets,\n            currentUser: currentUser,\n            onUpdate: handleUpdateTicket\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 486,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 483,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          path: \"/admin/requests\",\n          element: /*#__PURE__*/_jsxDEV(ProtectedRoute, {\n            currentUser: currentUser,\n            requiredRole: ['ADMIN', 'APPROVER'],\n            children: /*#__PURE__*/_jsxDEV(RequestManagement, {\n              tickets: tickets,\n              currentUser: currentUser,\n              onUpdate: handleUpdateTicket\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 497,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 496,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 493,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          path: \"*\",\n          element: /*#__PURE__*/_jsxDEV(Navigate, {\n            to: \"/\",\n            replace: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 505,\n            columnNumber: 36\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 505,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 436,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 435,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 312,\n    columnNumber: 5\n  }, this);\n};\n_s(App, \"7wlnlvI7o+JkWXgScrhnnUUqogE=\");\n_c = App;\nexport default App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["useState","useEffect","BrowserRouter","Routes","Route","Navigate","Layout","RouteWrapper","MyTickets","Login","createTicket","getTickets","updateTicketStatus","updateTicket","getAllTicketsRaw","TicketDetail","RequestManagement","ProtectedRoute","jsxDEV","_jsxDEV","App","_s","_debugInfo$data","tickets","setTickets","isAuthenticated","setIsAuthenticated","currentUser","setCurrentUser","debugInfo","setDebugInfo","visible","data","token","localStorage","getItem","savedUser","parsedUser","JSON","parse","console","log","length","fetchTickets","error","removeItem","dateRange","end","Date","start","startDate","endDate","safeRange","toISOString","response","undefined","status","message","timestamp","Array","isArray","ticketsArray","id","_id","title","date","requestDate","warn","handleLoginSuccess","user","handleLogout","handleCreateRequest","window","location","href","handleTicketSubmit","ticketData","navigate","alert","handleTicketStatusChange","ticketId","newStatus","handleUpdateTicket","updatedData","debugApiCall","_localStorage$getItem","rawResponse","endpoint","auth","tokenExists","tokenLength","userInfo","role","email","_error$response","details","stack","createTestTicket","testTicketData","description","requesterId","department","chemicalConfig","machineId","machineName","chemicalType","concentration","temperature","flowRate","_error$response2","closeDebugPanel","onLoginSuccess","fileName","_jsxFileName","lineNumber","columnNumber","children","style","position","top","left","right","bottom","backgroundColor","zIndex","overflow","padding","color","fontFamily","borderRadius","maxWidth","margin","boxShadow","display","justifyContent","marginBottom","onClick","border","cursor","overflowX","maxHeight","stringify","textAlign","gap","path","element","onLogout","index","component","onCreateRequest","onStatusChange","onSubmit","onUpdate","requiredRole","to","replace","_c","$RefreshReg$"],"sources":["/Users/a667227/Desktop/Work/ticket-management/src/App.tsx"],"sourcesContent":["import { FC, useState, useEffect } from 'react';\nimport { BrowserRouter, Routes, Route, Navigate, useNavigate } from 'react-router-dom';\nimport './App.css';\nimport Layout from './components/Layout';\nimport RouteWrapper from './components/RouteWrapper';\nimport MyTickets from './components/tickets/MyTickets';\nimport Login from './components/Login';\nimport { User, Ticket, TicketStatus } from './types/system';\nimport { createTicket, getTickets, updateTicketStatus, updateTicket, getAllTicketsRaw } from './services/api';\nimport TicketDetail from './components/tickets/TicketDetail';\nimport RequestManagement from './components/admin/RequestManagement';\nimport ProtectedRoute from './components/ProtectedRoute';\n\nconst App: FC = () => {\n  const [tickets, setTickets] = useState<Ticket[]>([]);\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n  const [currentUser, setCurrentUser] = useState<User | null>(null);\n  const [debugInfo, setDebugInfo] = useState<{ visible: boolean; data: any }>({\n    visible: false,\n    data: null\n  });\n\n  useEffect(() => {\n    // Check for existing auth token and user data\n    const token = localStorage.getItem('token');\n    const savedUser = localStorage.getItem('user');\n    \n    if (token && savedUser) {\n      try {\n        const parsedUser = JSON.parse(savedUser);\n        console.log('Loaded user:', parsedUser); // Debug log\n        console.log('Token found:', token ? 'Yes (length: ' + token.length + ')' : 'No');\n        setIsAuthenticated(true);\n        setCurrentUser(parsedUser);\n        // Fetch tickets when authenticated\n        fetchTickets();\n      } catch (error: any) {\n        console.error('Error parsing saved user data:', error);\n        // Handle corrupted user data by clearing it\n        localStorage.removeItem('token');\n        localStorage.removeItem('user');\n        setIsAuthenticated(false);\n      }\n    } else {\n      console.log('No authentication found. Token:', !!token, 'User:', !!savedUser);\n    }\n  }, []);\n\n  const fetchTickets = async (dateRange?: { startDate?: Date, endDate?: Date }) => {\n    try {\n      // Use a default date range if none provided (all time)\n      if (!dateRange) {\n        const end = new Date();\n        const start = new Date(2020, 0, 1); // Jan 1, 2020 instead of 365 days\n        dateRange = { startDate: start, endDate: end };\n      }\n      \n      // Ensure startDate and endDate are defined\n      const safeRange = {\n        startDate: dateRange.startDate || new Date(2020, 0, 1),\n        endDate: dateRange.endDate || new Date()\n      };\n      \n      console.log('App fetching tickets with date range:', {\n        startDate: safeRange.startDate.toISOString(),\n        endDate: safeRange.endDate.toISOString()\n      });\n      \n      const response = await getTickets(undefined, 1, 100, safeRange);\n      \n      // Check if there was an error in the response\n      if (response.error) {\n        console.error('Error in ticket response:', response.error);\n        setDebugInfo({\n          visible: true,\n          data: {\n            status: 'error',\n            message: 'Error fetching tickets',\n            error: response.error,\n            timestamp: new Date().toISOString()\n          }\n        });\n        // Keep existing tickets instead of setting empty array\n        return;\n      }\n      \n      // Handle response with tickets\n      if (response.tickets && Array.isArray(response.tickets)) {\n        const ticketsArray = response.tickets;\n        console.log(`App received ${ticketsArray.length} tickets`);\n        \n        // Log first ticket data for debugging\n        if (ticketsArray.length > 0) {\n          console.log('First ticket sample:', {\n            id: ticketsArray[0]._id,\n            title: ticketsArray[0].title,\n            status: ticketsArray[0].status,\n            date: ticketsArray[0].requestDate\n          });\n        }\n        \n        setTickets(ticketsArray);\n      } else {\n        console.warn('Unexpected ticket response format:', response);\n        setTickets([]);\n      }\n    } catch (error: any) {\n      console.error('Error fetching tickets:', error);\n      setDebugInfo({\n        visible: true,\n        data: {\n          status: 'error',\n          message: 'Exception fetching tickets',\n          error: error?.message || 'Unknown error',\n          timestamp: new Date().toISOString()\n        }\n      });\n      \n      // If we get an authentication error, clear the token and redirect to login\n      if (error?.response && error.response.status === 401) {\n        console.error('Authentication error. Redirecting to login.');\n        localStorage.removeItem('token');\n        localStorage.removeItem('user');\n        setIsAuthenticated(false);\n        setCurrentUser(null);\n      }\n    }\n  };\n\n  const handleLoginSuccess = (token: string, user: User) => {\n    setIsAuthenticated(true);\n    setCurrentUser(user);\n    // Fetch tickets after successful login\n    fetchTickets();\n  };\n\n  const handleLogout = () => {\n    localStorage.removeItem('token');\n    localStorage.removeItem('user');\n    setIsAuthenticated(false);\n    setCurrentUser(null);\n    setTickets([]);\n  };\n\n  const handleCreateRequest = () => {\n    // Use navigate directly in components that need it\n    window.location.href = '/tickets/create';\n  };\n\n  const handleTicketSubmit = async (ticketData: Omit<Ticket, 'id' | 'status' | 'createdAt' | 'updatedAt'>, navigate: (path: string) => void) => {\n    try {\n      await createTicket(ticketData);\n      // Fetch updated tickets list\n      await fetchTickets();\n      navigate('/tickets');\n      alert('Ticket created successfully!');\n    } catch (error) {\n      console.error('Error creating ticket:', error);\n      alert('Failed to create ticket. Please try again.');\n    }\n  };\n\n  const handleTicketStatusChange = async (ticketId: string, newStatus: TicketStatus) => {\n    try {\n      await updateTicketStatus(ticketId, newStatus);\n      // Fetch updated tickets list\n      await fetchTickets();\n    } catch (error) {\n      console.error('Error updating ticket status:', error);\n      alert('Failed to update ticket status. Please try again.');\n    }\n  };\n\n  const handleUpdateTicket = async (ticketId: string, updatedData: Partial<Ticket>) => {\n    try {\n      if ('status' in updatedData) {\n        // Use status-specific endpoint for status updates\n        await updateTicketStatus(ticketId, updatedData.status as TicketStatus);\n      } else {\n        // Use general update endpoint for other updates\n        await updateTicket(ticketId, updatedData);\n      }\n      // Fetch updated tickets list\n      await fetchTickets();\n    } catch (error) {\n      console.error('Error updating ticket:', error);\n      alert('Failed to update ticket. Please try again.');\n    }\n  };\n\n  // Add debug function to directly fetch and display the raw API response\n  const debugApiCall = async () => {\n    try {\n      setDebugInfo({\n        visible: true,\n        data: { status: 'loading', message: 'Fetching data from API...' }\n      });\n      \n      // Call the raw tickets endpoint\n      const rawResponse = await getAllTicketsRaw();\n      \n      console.log('DEBUG: Raw API response:', rawResponse);\n      \n      // Show detailed debug info\n      setDebugInfo({\n        visible: true,\n        data: {\n          status: 'success',\n          timestamp: new Date().toISOString(),\n          endpoint: '/tickets',\n          response: rawResponse,\n          auth: {\n            tokenExists: !!localStorage.getItem('token'),\n            tokenLength: localStorage.getItem('token')?.length || 0,\n            userInfo: currentUser ? {\n              id: currentUser._id,\n              role: currentUser.role,\n              email: currentUser.email\n            } : 'No user data'\n          }\n        }\n      });\n    } catch (error: any) {\n      console.error('Debug API call failed:', error);\n      setDebugInfo({\n        visible: true,\n        data: {\n          status: 'error',\n          timestamp: new Date().toISOString(),\n          message: error?.message || 'Unknown error',\n          details: error?.response?.data || {},\n          stack: error?.stack || ''\n        }\n      });\n    }\n  };\n\n  // Improved test ticket creation with detailed responses\n  const createTestTicket = async () => {\n    if (!currentUser) return;\n    \n    try {\n      console.log('Creating test ticket...');\n      setDebugInfo({\n        visible: true,\n        data: { status: 'loading', message: 'Creating test ticket...' }\n      });\n      \n      const testTicketData: Omit<Ticket, 'id' | 'status' | 'createdAt' | 'updatedAt'> = {\n        _id: '', // This will be generated by the server\n        title: 'Test Ticket ' + new Date().toISOString(),\n        description: 'This is a test ticket created for debugging.',\n        requesterId: currentUser._id,\n        department: currentUser.department,\n        chemicalConfig: {\n          machineId: 'TEST-MACHINE',\n          machineName: 'Test Machine',\n          chemicalType: 'Test Chemical',\n          concentration: 1.0,\n          temperature: 25.0,\n          flowRate: 1.0\n        },\n        requestDate: new Date().toISOString()\n      };\n      \n      const response = await createTicket(testTicketData);\n      console.log('Test ticket created successfully:', response);\n      \n      // Show success info\n      setDebugInfo({\n        visible: true,\n        data: {\n          status: 'success',\n          message: 'Test ticket created successfully',\n          ticketData: response,\n          timestamp: new Date().toISOString()\n        }\n      });\n      \n      // Fetch tickets again\n      fetchTickets();\n    } catch (error: any) {\n      console.error('Error creating test ticket:', error);\n      setDebugInfo({\n        visible: true,\n        data: {\n          status: 'error',\n          message: `Error creating test ticket: ${error?.message || 'Unknown error'}`,\n          details: error?.response?.data || {},\n          timestamp: new Date().toISOString()\n        }\n      });\n      alert(`Error creating test ticket: ${error?.message || 'Unknown error'}`);\n    }\n  };\n\n  // Function to close debug panel\n  const closeDebugPanel = () => {\n    setDebugInfo({ ...debugInfo, visible: false });\n  };\n\n  if (!isAuthenticated || !currentUser) {\n    return <Login onLoginSuccess={handleLoginSuccess} />;\n  }\n\n  // If authenticated but no tickets, add a debug button\n  if (tickets.length === 0) {\n    console.log('No tickets found. Adding debug UI...');\n  }\n\n  return (\n    <BrowserRouter>\n      {/* Debug panel */}\n      {debugInfo.visible && (\n        <div style={{\n          position: 'fixed',\n          top: 0,\n          left: 0,\n          right: 0,\n          bottom: 0,\n          backgroundColor: 'rgba(0,0,0,0.8)',\n          zIndex: 9999,\n          overflow: 'auto',\n          padding: '20px',\n          color: '#fff',\n          fontFamily: 'monospace'\n        }}>\n          <div style={{ \n            backgroundColor: '#1e1e1e', \n            padding: '20px', \n            borderRadius: '8px',\n            maxWidth: '1200px',\n            margin: '0 auto',\n            boxShadow: '0 0 20px rgba(0,0,0,0.5)'\n          }}>\n            <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: '20px' }}>\n              <h2 style={{ color: '#61dafb', margin: 0 }}>API Debug Information</h2>\n              <button \n                onClick={closeDebugPanel}\n                style={{\n                  backgroundColor: '#e74c3c',\n                  color: 'white',\n                  border: 'none',\n                  padding: '5px 15px',\n                  borderRadius: '4px',\n                  cursor: 'pointer'\n                }}\n              >\n                Close\n              </button>\n            </div>\n            \n            <div style={{ \n              backgroundColor: '#2d2d2d', \n              padding: '15px', \n              borderRadius: '4px',\n              overflowX: 'auto'\n            }}>\n              <pre style={{ \n                maxHeight: '80vh', \n                margin: 0, \n                color: debugInfo.data?.status === 'error' ? '#ff6b6b' : '#a3e635' \n              }}>\n                {JSON.stringify(debugInfo.data, null, 2)}\n              </pre>\n            </div>\n          </div>\n        </div>\n      )}\n      \n      {/* Debug tools bar */}\n      <div style={{\n        padding: '10px',\n        backgroundColor: '#343a40',\n        color: 'white',\n        textAlign: 'center',\n        position: 'sticky',\n        top: 0,\n        zIndex: 1000,\n        display: 'flex',\n        justifyContent: 'center',\n        gap: '10px'\n      }}>\n        <button \n          onClick={createTestTicket}\n          style={{\n            padding: '5px 10px',\n            backgroundColor: '#28a745',\n            color: 'white',\n            border: 'none',\n            borderRadius: '4px'\n          }}\n        >\n          Create Test Ticket\n        </button>\n        <button\n          onClick={debugApiCall}\n          style={{\n            padding: '5px 10px',\n            backgroundColor: '#007bff',\n            color: 'white',\n            border: 'none', \n            borderRadius: '4px'\n          }}\n        >\n          Debug API Response\n        </button>\n        <button\n          onClick={() => fetchTickets()}\n          style={{\n            padding: '5px 10px',\n            backgroundColor: '#6c757d',\n            color: 'white',\n            border: 'none', \n            borderRadius: '4px'\n          }}\n        >\n          Refresh Tickets\n        </button>\n      </div>\n\n      {/* Existing no tickets warning - we'll keep this but make it less prominent */}\n      {tickets.length === 0 && (\n        <div style={{\n          padding: '10px',\n          backgroundColor: '#f8d7da',\n          color: '#721c24',\n          textAlign: 'center',\n          margin: '10px'\n        }}>\n          <p>No tickets found. Use the debug tools above to investigate.</p>\n        </div>\n      )}\n\n      <Routes>\n        <Route \n          path=\"/\" \n          element={\n            <Layout \n              currentUser={currentUser}\n              onLogout={handleLogout}\n            />\n          }\n        >\n          <Route index element={\n            <RouteWrapper \n              component=\"home\"\n              tickets={tickets}\n              currentUser={currentUser}\n              onCreateRequest={handleCreateRequest}\n              onStatusChange={handleTicketStatusChange}\n            />\n          } />\n          <Route \n            path=\"tickets\"\n            element={\n              <MyTickets\n                tickets={tickets}\n                currentUser={currentUser}\n              />\n            }\n          />\n          <Route \n            path=\"tickets/create\" \n            element={\n              <RouteWrapper \n                component=\"create\"\n                currentUser={currentUser}\n                onCreateRequest={handleCreateRequest}\n                onSubmit={handleTicketSubmit}\n              />\n            } \n          />\n          <Route \n            path=\"/my-tickets\" \n            element={\n              <MyTickets \n                tickets={tickets} \n                currentUser={currentUser}\n              />\n            } \n          />\n          <Route \n            path=\"/tickets/:id\" \n            element={\n              <TicketDetail \n                tickets={tickets} \n                currentUser={currentUser} \n                onUpdate={handleUpdateTicket} \n              />\n            } \n          />\n          <Route \n            path=\"/admin/requests\" \n            element={\n              <ProtectedRoute currentUser={currentUser} requiredRole={['ADMIN', 'APPROVER']}>\n                <RequestManagement\n                  tickets={tickets}\n                  currentUser={currentUser}\n                  onUpdate={handleUpdateTicket}\n                />\n              </ProtectedRoute>\n            }\n          />\n          <Route path=\"*\" element={<Navigate to=\"/\" replace />} />\n        </Route>\n      </Routes>\n    </BrowserRouter>\n  );\n};\n\nexport default App; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}