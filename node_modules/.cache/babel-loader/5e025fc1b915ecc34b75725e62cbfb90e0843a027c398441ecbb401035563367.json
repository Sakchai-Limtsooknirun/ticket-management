{"ast":null,"code":"var _jsxFileName = \"/Users/a667227/Desktop/Work/ticket-management/src/components/TaskBoard.tsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport { useState, useEffect } from 'react';\nimport '../styles/TaskBoard.css';\nimport { DragDropContext, Droppable, Draggable } from 'react-beautiful-dnd';\nimport Toast from './Toast';\nimport { useNavigate } from 'react-router-dom';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n// Updated StrictModeDroppable component to fix React 18 warnings\n// This is a compatibility wrapper for react-beautiful-dnd in React 18 with StrictMode\nconst StrictModeDroppable = ({\n  children,\n  ...props\n}) => {\n  _s();\n  const [enabled, setEnabled] = useState(false);\n  useEffect(() => {\n    // Wait until after client-side hydration to enable\n    const animation = requestAnimationFrame(() => {\n      setEnabled(true);\n    });\n    return () => {\n      cancelAnimationFrame(animation);\n    };\n  }, []);\n  if (!enabled) {\n    return null;\n  }\n  return /*#__PURE__*/_jsxDEV(Droppable, {\n    ...props,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 34,\n    columnNumber: 10\n  }, this);\n};\n_s(StrictModeDroppable, \"KO045EdmUKRrcVNzr+fxbg9aW04=\");\n_c = StrictModeDroppable;\nconst TaskBoard = ({\n  tickets,\n  onStatusChange,\n  currentUser\n}) => {\n  _s2();\n  const columns = ['DRAFT', 'PENDING', 'APPROVED', 'REJECTED'];\n  const [isDragging, setIsDragging] = useState(false);\n  const [toast, setToast] = useState({\n    message: '',\n    visible: false\n  });\n  const navigate = useNavigate();\n\n  // State for date filter\n  const [dateRange, setDateRange] = useState(() => {\n    const end = new Date();\n    const start = new Date();\n    start.setDate(start.getDate() - 365); // Changed to show 1 year of tickets by default\n    return {\n      startDate: start,\n      endDate: end\n    };\n  });\n\n  // Log received tickets for debugging\n  useEffect(() => {\n    console.log('TaskBoard received tickets:', tickets.length);\n    console.log('Current date range:', {\n      startDate: dateRange.startDate.toISOString(),\n      endDate: dateRange.endDate.toISOString()\n    });\n  }, [tickets, dateRange]);\n\n  // State for pagination per column\n  const [pagination, setPagination] = useState({\n    'DRAFT': {\n      page: 1,\n      limit: 20\n    },\n    'PENDING': {\n      page: 1,\n      limit: 20\n    },\n    'APPROVED': {\n      page: 1,\n      limit: 20\n    },\n    'REJECTED': {\n      page: 1,\n      limit: 20\n    }\n  });\n\n  // Filter tickets based on user role\n  const filteredTickets = tickets.filter(ticket => {\n    // Debug ticket date\n    const ticketDate = new Date(ticket.requestDate || '');\n    console.log('Filtering ticket:', {\n      id: ticket._id,\n      title: ticket.title,\n      status: ticket.status,\n      date: ticket.requestDate,\n      ticketDate: ticketDate.toISOString(),\n      inRange: ticketDate >= dateRange.startDate && ticketDate <= dateRange.endDate\n    });\n\n    // Date range filter\n    if (ticketDate < dateRange.startDate || ticketDate > dateRange.endDate) {\n      return false;\n    }\n\n    // User role filter\n    if (currentUser.role === 'ADMIN') return true;\n    if (currentUser.role === 'APPROVER') {\n      // Approvers can see all tickets in all statuses\n      return true;\n    }\n    return ticket.requesterId === currentUser._id;\n  });\n\n  // Log filtered tickets for debugging\n  useEffect(() => {\n    console.log('Filtered tickets count:', filteredTickets.length);\n  }, [filteredTickets]);\n\n  // Group tickets by status\n  const ticketsByStatus = columns.reduce((acc, status) => {\n    acc[status] = filteredTickets.filter(ticket => ticket.status === status);\n    return acc;\n  }, {});\n\n  // Get visible tickets per column with pagination\n  const getVisibleTickets = status => {\n    const {\n      page,\n      limit\n    } = pagination[status];\n    const start = (page - 1) * limit;\n    const end = start + limit;\n    return ticketsByStatus[status].slice(start, end);\n  };\n\n  // Handle page change for a column\n  const handlePageChange = (status, increment) => {\n    setPagination(prev => {\n      const columnPagination = {\n        ...prev[status]\n      };\n      columnPagination.page += increment;\n\n      // Ensure page is within valid range\n      const maxPage = Math.ceil(ticketsByStatus[status].length / columnPagination.limit) || 1;\n      if (columnPagination.page < 1) columnPagination.page = 1;\n      if (columnPagination.page > maxPage) columnPagination.page = maxPage;\n      return {\n        ...prev,\n        [status]: columnPagination\n      };\n    });\n  };\n\n  // Handle date filter changes\n  const handleDateFilterChange = (type, dateString) => {\n    // Parse the date in a safer way to avoid timezone issues\n    const date = new Date(dateString + 'T00:00:00');\n    console.log('Date changed:', {\n      type,\n      dateString,\n      parsedDate: date.toISOString()\n    });\n    setDateRange(prev => ({\n      ...prev,\n      [type === 'start' ? 'startDate' : 'endDate']: date\n    }));\n\n    // Reset pagination when filter changes\n    setPagination({\n      'DRAFT': {\n        page: 1,\n        limit: 20\n      },\n      'PENDING': {\n        page: 1,\n        limit: 20\n      },\n      'APPROVED': {\n        page: 1,\n        limit: 20\n      },\n      'REJECTED': {\n        page: 1,\n        limit: 20\n      }\n    });\n  };\n\n  // Check if the user can move the ticket from source to destination status\n  const canMoveTicket = (ticket, sourceStatus, destinationStatus) => {\n    const role = currentUser.role;\n\n    // ADMIN can move tickets freely between any status\n    if (role === 'ADMIN') return true;\n\n    // APPROVER can only move tickets forward in the workflow, but cannot move from DRAFT\n    if (role === 'APPROVER') {\n      // Define workflow order for all status determinations\n      const workflowOrder = {\n        'DRAFT': 0,\n        'PENDING': 1,\n        'APPROVED': 2,\n        'REJECTED': 2 // APPROVED and REJECTED are at the same level\n      };\n\n      // Approvers can move their own tickets with some restrictions\n      if (ticket.requesterId === currentUser._id) {\n        // Prevent moving backward from APPROVED or REJECTED to earlier statuses\n        if ((sourceStatus === 'APPROVED' || sourceStatus === 'REJECTED') && (destinationStatus === 'PENDING' || destinationStatus === 'DRAFT')) {\n          return false;\n        }\n        return true; // Allow all other movements for own tickets\n      }\n\n      // For other people's tickets, check if the move is forward in the workflow\n      return workflowOrder[destinationStatus] > workflowOrder[sourceStatus];\n    }\n\n    // REQUESTER can only move their own tickets from DRAFT to PENDING\n    if (role === 'REQUESTER') {\n      if (ticket.requesterId === currentUser._id && sourceStatus === 'DRAFT' && destinationStatus === 'PENDING') {\n        return true;\n      }\n      return false;\n    }\n    return false;\n  };\n  const getRequesterName = ticket => {\n    var _ticket$requester;\n    return ((_ticket$requester = ticket.requester) === null || _ticket$requester === void 0 ? void 0 : _ticket$requester.fullName) || 'Unknown User';\n  };\n  const handleDragEnd = result => {\n    setIsDragging(false);\n    const {\n      draggableId,\n      source,\n      destination\n    } = result;\n\n    // Drop outside any droppable area or same position\n    if (!destination || source.droppableId === destination.droppableId && source.index === destination.index) {\n      return;\n    }\n\n    // The draggableId is the ticket ID\n    const ticketId = draggableId;\n\n    // Source and destination are the status columns\n    const sourceStatus = source.droppableId;\n    const destinationStatus = destination.droppableId;\n    const ticket = tickets.find(t => t._id === ticketId);\n    if (!ticket) return;\n\n    // Check if the user has permission to move the ticket\n    if (canMoveTicket(ticket, sourceStatus, destinationStatus)) {\n      onStatusChange(ticketId, destinationStatus);\n    } else {\n      // Show toast notification for permission error\n      setToast({\n        message: `You don't have permission to move this ticket to ${destinationStatus} status`,\n        visible: true\n      });\n    }\n  };\n  const handleDragStart = () => {\n    setIsDragging(true);\n  };\n\n  // Handle closing the toast\n  const handleCloseToast = () => {\n    setToast({\n      ...toast,\n      visible: false\n    });\n  };\n  const checkDragDisabled = (ticket, status) => {\n    // ADMIN can move any ticket\n    if (currentUser.role === 'ADMIN') return false;\n\n    // APPROVER permissions\n    if (currentUser.role === 'APPROVER') {\n      // Allow APPROVERs to drag their own tickets from any status\n      if (ticket.requesterId === currentUser._id) return false;\n\n      // APPROVERs cannot drag other people's tickets that are in DRAFT status\n      return status === 'DRAFT';\n    }\n\n    // REQUESTER can only move their own tickets from DRAFT to PENDING\n    if (currentUser.role === 'REQUESTER') {\n      return !(ticket.requesterId === currentUser._id && status === 'DRAFT');\n    }\n    return true;\n  };\n\n  // Add a click handler to navigate to ticket detail\n  const handleTicketClick = ticketId => {\n    if (!isDragging) {\n      navigate(`/tickets/${ticketId}`);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [toast.visible && /*#__PURE__*/_jsxDEV(Toast, {\n      message: toast.message,\n      type: \"error\",\n      onClose: handleCloseToast\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 277,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"taskboard-controls\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"date-filter\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"filter-group\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"From:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 287,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"date\",\n            value: dateRange.startDate.toISOString().split('T')[0],\n            onChange: e => handleDateFilterChange('start', e.target.value)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 288,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 286,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"filter-group\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            children: \"To:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 295,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            type: \"date\",\n            value: dateRange.endDate.toISOString().split('T')[0],\n            onChange: e => handleDateFilterChange('end', e.target.value)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 296,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 294,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 285,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 284,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(DragDropContext, {\n      onDragEnd: handleDragEnd,\n      onDragStart: handleDragStart,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"task-board\",\n        children: columns.map(status => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"task-column\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"column-title\",\n            children: [status, /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"ticket-count\",\n              children: [\"(\", ticketsByStatus[status].length, \")\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 311,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 309,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(StrictModeDroppable, {\n            droppableId: status,\n            children: (provided, snapshot) => /*#__PURE__*/_jsxDEV(\"div\", {\n              ref: provided.innerRef,\n              ...provided.droppableProps,\n              className: `task-list ${snapshot.isDraggingOver ? 'drop-allowed' : ''}`,\n              children: [getVisibleTickets(status).map((ticket, index) => {\n                // Determine if this ticket can be dragged\n                const isDragDisabled = checkDragDisabled(ticket, status);\n                return /*#__PURE__*/_jsxDEV(Draggable, {\n                  draggableId: ticket._id,\n                  index: index,\n                  isDragDisabled: isDragDisabled,\n                  children: (provided, snapshot) => /*#__PURE__*/_jsxDEV(\"div\", {\n                    ref: provided.innerRef,\n                    ...provided.draggableProps,\n                    ...provided.dragHandleProps,\n                    className: `task-card ${snapshot.isDragging ? 'is-dragging' : ''} ${isDragDisabled ? 'not-draggable' : ''}`,\n                    onClick: () => handleTicketClick(ticket._id),\n                    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"task-priority\",\n                      \"data-priority\": ticket.department\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 342,\n                      columnNumber: 31\n                    }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n                      children: ticket.title\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 343,\n                      columnNumber: 31\n                    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                      children: ticket.description\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 344,\n                      columnNumber: 31\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      className: \"task-meta\",\n                      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                        className: \"assignee\",\n                        children: getRequesterName(ticket)\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 346,\n                        columnNumber: 33\n                      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                        className: \"due-date\",\n                        children: ticket.requestDate ? new Date(ticket.requestDate).toLocaleDateString() : 'No date'\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 347,\n                        columnNumber: 33\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 345,\n                      columnNumber: 31\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 335,\n                    columnNumber: 29\n                  }, this)\n                }, ticket._id, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 328,\n                  columnNumber: 25\n                }, this);\n              }), provided.placeholder, ticketsByStatus[status].length > pagination[status].limit && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"column-pagination\",\n                children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: () => handlePageChange(status, -1),\n                  disabled: pagination[status].page === 1,\n                  className: \"pagination-btn\",\n                  children: \"\\xAB Prev\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 361,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"page-indicator\",\n                  children: [pagination[status].page, \" /\", Math.ceil(ticketsByStatus[status].length / pagination[status].limit)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 368,\n                  columnNumber: 25\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  onClick: () => handlePageChange(status, 1),\n                  disabled: pagination[status].page >= Math.ceil(ticketsByStatus[status].length / pagination[status].limit),\n                  className: \"pagination-btn\",\n                  children: \"Next \\xBB\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 372,\n                  columnNumber: 25\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 360,\n                columnNumber: 23\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 318,\n              columnNumber: 19\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 316,\n            columnNumber: 15\n          }, this)]\n        }, status, true, {\n          fileName: _jsxFileName,\n          lineNumber: 308,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 306,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 305,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true);\n};\n_s2(TaskBoard, \"RpqIhSHdHYxxSz4sU7bRJsjfE/4=\", false, function () {\n  return [useNavigate];\n});\n_c2 = TaskBoard;\nexport default TaskBoard;\nvar _c, _c2;\n$RefreshReg$(_c, \"StrictModeDroppable\");\n$RefreshReg$(_c2, \"TaskBoard\");","map":{"version":3,"names":["useState","useEffect","DragDropContext","Droppable","Draggable","Toast","useNavigate","jsxDEV","_jsxDEV","Fragment","_Fragment","StrictModeDroppable","children","props","_s","enabled","setEnabled","animation","requestAnimationFrame","cancelAnimationFrame","fileName","_jsxFileName","lineNumber","columnNumber","_c","TaskBoard","tickets","onStatusChange","currentUser","_s2","columns","isDragging","setIsDragging","toast","setToast","message","visible","navigate","dateRange","setDateRange","end","Date","start","setDate","getDate","startDate","endDate","console","log","length","toISOString","pagination","setPagination","page","limit","filteredTickets","filter","ticket","ticketDate","requestDate","id","_id","title","status","date","inRange","role","requesterId","ticketsByStatus","reduce","acc","getVisibleTickets","slice","handlePageChange","increment","prev","columnPagination","maxPage","Math","ceil","handleDateFilterChange","type","dateString","parsedDate","canMoveTicket","sourceStatus","destinationStatus","workflowOrder","getRequesterName","_ticket$requester","requester","fullName","handleDragEnd","result","draggableId","source","destination","droppableId","index","ticketId","find","t","handleDragStart","handleCloseToast","checkDragDisabled","handleTicketClick","onClose","className","value","split","onChange","e","target","onDragEnd","onDragStart","map","provided","snapshot","ref","innerRef","droppableProps","isDraggingOver","isDragDisabled","draggableProps","dragHandleProps","onClick","department","description","toLocaleDateString","placeholder","disabled","_c2","$RefreshReg$"],"sources":["/Users/a667227/Desktop/Work/ticket-management/src/components/TaskBoard.tsx"],"sourcesContent":["import { FC, useState, useEffect, ReactElement, useCallback } from 'react';\nimport '../styles/TaskBoard.css';\nimport { Ticket, TicketStatus, User } from '../types/system';\nimport { DragDropContext, Droppable, Draggable, DropResult, DroppableProps, DroppableProvided, DroppableStateSnapshot } from 'react-beautiful-dnd';\nimport Toast from './Toast';\nimport { useNavigate } from 'react-router-dom';\n\ninterface TaskBoardProps {\n  tickets: Ticket[];\n  onStatusChange: (ticketId: string, newStatus: TicketStatus) => void;\n  currentUser: User;\n}\n\n// Updated StrictModeDroppable component to fix React 18 warnings\n// This is a compatibility wrapper for react-beautiful-dnd in React 18 with StrictMode\nconst StrictModeDroppable = ({ children, ...props }: DroppableProps & { children: (provided: DroppableProvided, snapshot: DroppableStateSnapshot) => ReactElement }) => {\n  const [enabled, setEnabled] = useState(false);\n  \n  useEffect(() => {\n    // Wait until after client-side hydration to enable\n    const animation = requestAnimationFrame(() => {\n      setEnabled(true);\n    });\n    \n    return () => {\n      cancelAnimationFrame(animation);\n    };\n  }, []);\n  \n  if (!enabled) {\n    return null;\n  }\n  \n  return <Droppable {...props}>{children}</Droppable>;\n};\n\nconst TaskBoard: FC<TaskBoardProps> = ({ tickets, onStatusChange, currentUser }) => {\n  const columns: TicketStatus[] = ['DRAFT', 'PENDING', 'APPROVED', 'REJECTED'];\n  const [isDragging, setIsDragging] = useState(false);\n  const [toast, setToast] = useState<{ message: string; visible: boolean }>({\n    message: '',\n    visible: false\n  });\n  const navigate = useNavigate();\n  \n  // State for date filter\n  const [dateRange, setDateRange] = useState(() => {\n    const end = new Date();\n    const start = new Date();\n    start.setDate(start.getDate() - 365); // Changed to show 1 year of tickets by default\n    return { startDate: start, endDate: end };\n  });\n  \n  // Log received tickets for debugging\n  useEffect(() => {\n    console.log('TaskBoard received tickets:', tickets.length);\n    console.log('Current date range:', { \n      startDate: dateRange.startDate.toISOString(), \n      endDate: dateRange.endDate.toISOString() \n    });\n  }, [tickets, dateRange]);\n  \n  // State for pagination per column\n  const [pagination, setPagination] = useState<{[key in TicketStatus]: {page: number, limit: number}}>({\n    'DRAFT': {page: 1, limit: 20},\n    'PENDING': {page: 1, limit: 20},\n    'APPROVED': {page: 1, limit: 20},\n    'REJECTED': {page: 1, limit: 20}\n  });\n  \n  // Filter tickets based on user role\n  const filteredTickets = tickets.filter(ticket => {\n    // Debug ticket date\n    const ticketDate = new Date(ticket.requestDate || '');\n    console.log('Filtering ticket:', { \n      id: ticket._id,\n      title: ticket.title,\n      status: ticket.status, \n      date: ticket.requestDate,\n      ticketDate: ticketDate.toISOString(),\n      inRange: ticketDate >= dateRange.startDate && ticketDate <= dateRange.endDate\n    });\n    \n    // Date range filter\n    if (ticketDate < dateRange.startDate || ticketDate > dateRange.endDate) {\n      return false;\n    }\n    \n    // User role filter\n    if (currentUser.role === 'ADMIN') return true;\n    if (currentUser.role === 'APPROVER') {\n      // Approvers can see all tickets in all statuses\n      return true;\n    }\n    return ticket.requesterId === currentUser._id;\n  });\n\n  // Log filtered tickets for debugging\n  useEffect(() => {\n    console.log('Filtered tickets count:', filteredTickets.length);\n  }, [filteredTickets]);\n  \n  // Group tickets by status\n  const ticketsByStatus = columns.reduce((acc, status) => {\n    acc[status] = filteredTickets.filter(ticket => ticket.status === status);\n    return acc;\n  }, {} as {[key in TicketStatus]: Ticket[]});\n  \n  // Get visible tickets per column with pagination\n  const getVisibleTickets = (status: TicketStatus) => {\n    const { page, limit } = pagination[status];\n    const start = (page - 1) * limit;\n    const end = start + limit;\n    return ticketsByStatus[status].slice(start, end);\n  };\n  \n  // Handle page change for a column\n  const handlePageChange = (status: TicketStatus, increment: number) => {\n    setPagination(prev => {\n      const columnPagination = {...prev[status]};\n      columnPagination.page += increment;\n      \n      // Ensure page is within valid range\n      const maxPage = Math.ceil(ticketsByStatus[status].length / columnPagination.limit) || 1;\n      if (columnPagination.page < 1) columnPagination.page = 1;\n      if (columnPagination.page > maxPage) columnPagination.page = maxPage;\n      \n      return {...prev, [status]: columnPagination};\n    });\n  };\n  \n  // Handle date filter changes\n  const handleDateFilterChange = (type: 'start' | 'end', dateString: string) => {\n    // Parse the date in a safer way to avoid timezone issues\n    const date = new Date(dateString + 'T00:00:00');\n    console.log('Date changed:', { type, dateString, parsedDate: date.toISOString() });\n    \n    setDateRange(prev => ({\n      ...prev,\n      [type === 'start' ? 'startDate' : 'endDate']: date\n    }));\n    \n    // Reset pagination when filter changes\n    setPagination({\n      'DRAFT': {page: 1, limit: 20},\n      'PENDING': {page: 1, limit: 20},\n      'APPROVED': {page: 1, limit: 20},\n      'REJECTED': {page: 1, limit: 20}\n    });\n  };\n\n  // Check if the user can move the ticket from source to destination status\n  const canMoveTicket = (\n    ticket: Ticket,\n    sourceStatus: TicketStatus,\n    destinationStatus: TicketStatus\n  ): boolean => {\n    const role = currentUser.role;\n    \n    // ADMIN can move tickets freely between any status\n    if (role === 'ADMIN') return true;\n    \n    // APPROVER can only move tickets forward in the workflow, but cannot move from DRAFT\n    if (role === 'APPROVER') {\n      // Define workflow order for all status determinations\n      const workflowOrder: { [key in TicketStatus]: number } = {\n        'DRAFT': 0,\n        'PENDING': 1,\n        'APPROVED': 2,\n        'REJECTED': 2  // APPROVED and REJECTED are at the same level\n      };\n      \n      // Approvers can move their own tickets with some restrictions\n      if (ticket.requesterId === currentUser._id) {\n        // Prevent moving backward from APPROVED or REJECTED to earlier statuses\n        if ((sourceStatus === 'APPROVED' || sourceStatus === 'REJECTED') && \n            (destinationStatus === 'PENDING' || destinationStatus === 'DRAFT')) {\n          return false;\n        }\n        return true; // Allow all other movements for own tickets\n      }\n      \n      // For other people's tickets, check if the move is forward in the workflow\n      return workflowOrder[destinationStatus] > workflowOrder[sourceStatus];\n    }\n    \n    // REQUESTER can only move their own tickets from DRAFT to PENDING\n    if (role === 'REQUESTER') {\n      if (ticket.requesterId === currentUser._id && sourceStatus === 'DRAFT' && destinationStatus === 'PENDING') {\n        return true;\n      }\n      return false;\n    }\n    \n    return false;\n  };\n\n  const getRequesterName = (ticket: Ticket): string => {\n    return ticket.requester?.fullName || 'Unknown User';\n  };\n\n  const handleDragEnd = (result: DropResult) => {\n    setIsDragging(false);\n    \n    const { draggableId, source, destination } = result;\n    \n    // Drop outside any droppable area or same position\n    if (!destination || \n        (source.droppableId === destination.droppableId && \n         source.index === destination.index)) {\n      return;\n    }\n    \n    // The draggableId is the ticket ID\n    const ticketId = draggableId;\n    \n    // Source and destination are the status columns\n    const sourceStatus = source.droppableId as TicketStatus;\n    const destinationStatus = destination.droppableId as TicketStatus;\n    \n    const ticket = tickets.find(t => t._id === ticketId);\n    \n    if (!ticket) return;\n    \n    // Check if the user has permission to move the ticket\n    if (canMoveTicket(ticket, sourceStatus, destinationStatus)) {\n      onStatusChange(ticketId, destinationStatus);\n    } else {\n      // Show toast notification for permission error\n      setToast({\n        message: `You don't have permission to move this ticket to ${destinationStatus} status`,\n        visible: true\n      });\n    }\n  };\n  \n  const handleDragStart = () => {\n    setIsDragging(true);\n  };\n\n  // Handle closing the toast\n  const handleCloseToast = () => {\n    setToast({ ...toast, visible: false });\n  };\n\n  const checkDragDisabled = (ticket: Ticket, status: TicketStatus): boolean => {\n    // ADMIN can move any ticket\n    if (currentUser.role === 'ADMIN') return false;\n    \n    // APPROVER permissions\n    if (currentUser.role === 'APPROVER') {\n      // Allow APPROVERs to drag their own tickets from any status\n      if (ticket.requesterId === currentUser._id) return false;\n      \n      // APPROVERs cannot drag other people's tickets that are in DRAFT status\n      return status === 'DRAFT';\n    }\n    \n    // REQUESTER can only move their own tickets from DRAFT to PENDING\n    if (currentUser.role === 'REQUESTER') {\n      return !(ticket.requesterId === currentUser._id && status === 'DRAFT');\n    }\n    \n    return true;\n  };\n\n  // Add a click handler to navigate to ticket detail\n  const handleTicketClick = (ticketId: string) => {\n    if (!isDragging) {\n      navigate(`/tickets/${ticketId}`);\n    }\n  };\n\n  return (\n    <>\n      {toast.visible && (\n        <Toast \n          message={toast.message} \n          type=\"error\" \n          onClose={handleCloseToast} \n        />\n      )}\n      \n      <div className=\"taskboard-controls\">\n        <div className=\"date-filter\">\n          <div className=\"filter-group\">\n            <label>From:</label>\n            <input \n              type=\"date\" \n              value={dateRange.startDate.toISOString().split('T')[0]}\n              onChange={(e) => handleDateFilterChange('start', e.target.value)}\n            />\n          </div>\n          <div className=\"filter-group\">\n            <label>To:</label>\n            <input \n              type=\"date\" \n              value={dateRange.endDate.toISOString().split('T')[0]}\n              onChange={(e) => handleDateFilterChange('end', e.target.value)}\n            />\n          </div>\n        </div>\n      </div>\n      \n      <DragDropContext onDragEnd={handleDragEnd} onDragStart={handleDragStart}>\n        <div className=\"task-board\">\n          {columns.map((status) => (\n            <div key={status} className=\"task-column\">\n              <h3 className=\"column-title\">\n                {status} \n                <span className=\"ticket-count\">\n                  ({ticketsByStatus[status].length})\n                </span>\n              </h3>\n              \n              <StrictModeDroppable droppableId={status}>\n                {(provided, snapshot) => (\n                  <div\n                    ref={provided.innerRef}\n                    {...provided.droppableProps}\n                    className={`task-list ${snapshot.isDraggingOver ? 'drop-allowed' : ''}`}\n                  >\n                    {getVisibleTickets(status).map((ticket, index) => {\n                      // Determine if this ticket can be dragged\n                      const isDragDisabled = checkDragDisabled(ticket, status);\n                        \n                      return (\n                        <Draggable \n                          key={ticket._id} \n                          draggableId={ticket._id}\n                          index={index}\n                          isDragDisabled={isDragDisabled}\n                        >\n                          {(provided, snapshot) => (\n                            <div\n                              ref={provided.innerRef}\n                              {...provided.draggableProps}\n                              {...provided.dragHandleProps}\n                              className={`task-card ${snapshot.isDragging ? 'is-dragging' : ''} ${isDragDisabled ? 'not-draggable' : ''}`}\n                              onClick={() => handleTicketClick(ticket._id)}\n                            >\n                              <div className=\"task-priority\" data-priority={ticket.department}></div>\n                              <h4>{ticket.title}</h4>\n                              <p>{ticket.description}</p>\n                              <div className=\"task-meta\">\n                                <span className=\"assignee\">{getRequesterName(ticket)}</span>\n                                <span className=\"due-date\">\n                                  {ticket.requestDate ? new Date(ticket.requestDate).toLocaleDateString() : 'No date'}\n                                </span>\n                              </div>\n                            </div>\n                          )}\n                        </Draggable>\n                      );\n                    })}\n                    {provided.placeholder}\n                    \n                    {/* Pagination controls */}\n                    {ticketsByStatus[status].length > pagination[status].limit && (\n                      <div className=\"column-pagination\">\n                        <button \n                          onClick={() => handlePageChange(status, -1)}\n                          disabled={pagination[status].page === 1}\n                          className=\"pagination-btn\"\n                        >\n                          &laquo; Prev\n                        </button>\n                        <span className=\"page-indicator\">\n                          {pagination[status].page} / \n                          {Math.ceil(ticketsByStatus[status].length / pagination[status].limit)}\n                        </span>\n                        <button \n                          onClick={() => handlePageChange(status, 1)}\n                          disabled={\n                            pagination[status].page >= \n                            Math.ceil(ticketsByStatus[status].length / pagination[status].limit)\n                          }\n                          className=\"pagination-btn\"\n                        >\n                          Next &raquo;\n                        </button>\n                      </div>\n                    )}\n                  </div>\n                )}\n              </StrictModeDroppable>\n            </div>\n          ))}\n        </div>\n      </DragDropContext>\n    </>\n  );\n};\n\nexport default TaskBoard; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}